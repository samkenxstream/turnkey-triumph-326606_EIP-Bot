{"version":3,"file":"withdrawn_exceptions.js","sourceRoot":"","sources":["../../../../src/modules/purifiers/withdrawn_exceptions.ts"],"names":[],"mappings":";;;AAAA,uCAAoD;AACpD,mCAAmC;AAE5B,MAAM,0BAA0B,GAAG,CAAC,WAAwB,EAAE,EAAE;IACrE,MAAM,YAAY,GAAG,IAAA,kBAAS,EAAC,WAAW,CAAC,CAAC;IAC5C,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,YAAY,CAAC;IAE1C,MAAM,gBAAgB,GAAG,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,mBAAmB,CAAC;IACnE,MAAM,gBAAgB,GAAG,CAAC,MAAM,CAAC,cAAc,CAAC,qBAAqB,CAAC;IACtE,MAAM,iBAAiB,GAAG,QAAQ,EAAE,IAAI,CAAC,MAAM,KAAK,kBAAS,CAAC,SAAS,CAAC;IAExE,kFAAkF;IAClF,IAAI,gBAAgB,IAAI,gBAAgB,IAAI,iBAAiB,EAAE;QAC7D,MAAM,CAAC,cAAc,CAAC,qBAAqB,GAAG,SAAS,CAAC;QACxD,MAAM,CAAC,YAAY,CAAC,mBAAmB,GAAG,SAAS,CAAC;QACpD,MAAM,CAAC,YAAY,CAAC,gBAAgB,GAAG,SAAS,CAAC;KAClD;IAED,OAAO;QACL,GAAG,WAAW;QACd,MAAM;KACP,CAAC;AACJ,CAAC,CAAC;AAnBW,QAAA,0BAA0B,8BAmBrC","sourcesContent":["import { EipStatus, TestResults } from \"src/domain\";\nimport { cloneDeep } from \"lodash\";\n\nexport const withdrawnExceptionPurifier = (testResults: TestResults) => {\n  const _testResults = cloneDeep(testResults);\n  const { errors, fileDiff } = _testResults;\n\n  const isChangingStatus = !!errors.headerErrors.constantStatusError;\n  const isAuthorApproved = !errors.approvalErrors.isAuthorApprovedError;\n  const isWithdrawnAtHead = fileDiff?.head.status === EipStatus.withdrawn;\n\n  // the author is allowed to change the status to withdrawn without editor approval\n  if (isChangingStatus && isAuthorApproved && isWithdrawnAtHead) {\n    errors.approvalErrors.isEditorApprovedError = undefined;\n    errors.headerErrors.constantStatusError = undefined;\n    errors.headerErrors.validStatusError = undefined;\n  }\n\n  return {\n    ...testResults,\n    errors\n  };\n};\n"]}